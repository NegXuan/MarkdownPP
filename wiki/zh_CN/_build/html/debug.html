

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>串口调试 &mdash; Firefly Wiki</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="启动模式说明" href="bootmode.html" />
    <link rel="prev" title="入手指南" href="started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Firefly-RK3399 Manual
          

          
            
            <img src="_static/Logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">上手教程</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="started.html">入手指南</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">串口调试</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#xuan-gou-shi-pei-qi">选购适配器</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ying-jian-lian-jie">硬件连接</a></li>
<li class="toctree-l2"><a class="reference internal" href="#chuan-kou-can-shu-pei-zhi">串口参数配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="#windows-shang-shi-yong-chuan-kou-tiao-shi">Windows 上使用串口调试</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#an-zhuang-qu-dong">安装驱动</a></li>
<li class="toctree-l3"><a class="reference internal" href="#an-zhuang-ruan-jian">安装软件</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ubuntu-shang-shi-yong-chuan-kou-tiao-shi">Ubuntu 上使用串口调试</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#an-zhuang">安装</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">烧写固件</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="bootmode.html">启动模式说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade_table.html">烧写须知(重要)</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade_firmware.html">升级固件</a></li>
<li class="toctree-l1"><a class="reference internal" href="maskrom_mode.html">MaskRom模式</a></li>
</ul>
<p class="caption"><span class="caption-text">Linux开发</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="linux_build_ubuntu_rootfs.html">创建 Ubuntu 根文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux_compile_gpt.html">编译 Ubuntu 固件 ( GPT )</a></li>
<li class="toctree-l1"><a class="reference internal" href="ubuntu_support.html">Ubuntu 应用层支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="buildroot_compile.html">编译 Buildroot 固件</a></li>
</ul>
<p class="caption"><span class="caption-text">Android开发</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="adb_use.html">ADB 使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="compile_android8.1_firmware.html">编译 Android8.1 固件</a></li>
<li class="toctree-l1"><a class="reference internal" href="customize_android_firmware.html">定制 Android 固件</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Firefly-RK3399 Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>串口调试</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/debug.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="chuan-kou-tiao-shi">
<h1>串口调试<a class="headerlink" href="#chuan-kou-tiao-shi" title="永久链接至标题">¶</a></h1>
<p>如果正在进行 U-Boot 或内核开发，USB 串口适配器（ USB 转串口 TTL 适配器的简称）对于检查系统启动日志非常有用，特别是在没有图形桌面显示的情况下。</p>
<div class="section" id="xuan-gou-shi-pei-qi">
<h2>选购适配器<a class="headerlink" href="#xuan-gou-shi-pei-qi" title="永久链接至标题">¶</a></h2>
<p>网店上有许多 USB 转串口的适配器，按芯片来分，有以下几种：</p>
<ul class="simple">
<li><p><a class="reference external" href="https://item.taobao.com/item.htm?spm=a1z10.5-c.w4002-12605442688.14.aa5e1e8srwECg&amp;id=546045713700">CP2104</a></p></li>
<li><p>PL2303</p></li>
<li><p>CH340</p></li>
</ul>
<p>一般来说，采用 CH340 芯片的适配器，性能比较稳定，价格上贵一些。</p>
<p><strong>注意：</strong> Firefly-RK3399 默认的波特率是 1500000，有些USB转串口芯片波特率无法达到 1500000，同一芯片的不同系列也可能会有差异，所以在选购之前一定要确认是否支持。</p>
</div>
<div class="section" id="ying-jian-lian-jie">
<h2>硬件连接<a class="headerlink" href="#ying-jian-lian-jie" title="永久链接至标题">¶</a></h2>
<p>串口转 USB 适配器，有四个引脚：</p>
<ul class="simple">
<li><p>3.3V 电源（NC），不需要连接</p></li>
<li><p>GND，串口的地线，接开发板串口的 GND 针</p></li>
<li><p>TXD，串口的输出线，接开发板串口的 TX 针</p></li>
<li><p>RXD，串口的输入线，接开发板串口的 RX 针</p></li>
</ul>
<p><strong>注意：</strong> 如使用其它串口适配器遇到 TX 和 RX 不能输入和输出的问题，可以尝试对调 TX 和 RX 的连接。</p>
<p>Firefly-RK3399 串口连接图：</p>
<p><img alt="_images/Firefly-RK3399_debug1.jpg" src="_images/Firefly-RK3399_debug1.jpg" /></p>
</div>
<div class="section" id="chuan-kou-can-shu-pei-zhi">
<h2>串口参数配置<a class="headerlink" href="#chuan-kou-can-shu-pei-zhi" title="永久链接至标题">¶</a></h2>
<p>Firefly-RK3399 使用以下串口参数：</p>
<ul class="simple">
<li><p>波特率：1500000</p></li>
<li><p>数据位：8</p></li>
<li><p>停止位：1</p></li>
<li><p>奇偶校验：无</p></li>
<li><p>流控：无</p></li>
</ul>
</div>
<div class="section" id="windows-shang-shi-yong-chuan-kou-tiao-shi">
<h2>Windows 上使用串口调试<a class="headerlink" href="#windows-shang-shi-yong-chuan-kou-tiao-shi" title="永久链接至标题">¶</a></h2>
<div class="section" id="an-zhuang-qu-dong">
<h3>安装驱动<a class="headerlink" href="#an-zhuang-qu-dong" title="永久链接至标题">¶</a></h3>
<p>下载驱动并安装:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://sparks.gogo.co.nz/ch340.html">CH340</a></p></li>
<li><p><a class="reference external" href="http://www.prolific.com.tw/US/ShowProduct.aspx?pcid=41">PL2303</a></p></li>
<li><p><a class="reference external" href="https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers">CP210X</a></p></li>
</ul>
<p>如果在 Win8 上不能正常使用 PL2303，参考<a class="reference external" href="http://blog.csdn.net/ropai/article/details/19619951">这篇文章</a>， 采用 3.3.5.122 或更老版本的旧驱动即可。</p>
<p>如果在 Windows 系统上安装官网的 CP210X 驱动，使用 PUTTY 或 SecureCRT 等工具设置串口波特率为 1500000，如果出现设置不了或无效的问题，可以下载旧版本<a class="reference external" href="http://t-firefly.oss-cn-hangzhou.aliyuncs.com/product/Tools/Driver/CP210X/CP210x_VCP_Windows.zip">驱动</a>。</p>
<p>插入适配器后，系统会提示发现新硬件，并初始化，之后可以在设备管理器找到对应的 COM 口：
<img alt="_images/debug2.png" src="_images/debug2.png" /></p>
</div>
<div class="section" id="an-zhuang-ruan-jian">
<h3>安装软件<a class="headerlink" href="#an-zhuang-ruan-jian" title="永久链接至标题">¶</a></h3>
<p>Windows 上一般用 putty 或 SecureCRT。其中 putty 是开源软件，在这里介绍一下，SecureCRT 的使用方法与之类似。</p>
<p>到这里<a class="reference external" href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">下载 putty</a>，建议下载 <code class="docutils literal notranslate"><span class="pre">putty.zip</span></code>，它包含了其它有用的工具：</p>
<ol class="simple">
<li><p>选择 “Connection type” 为 “Serial”。</p></li>
<li><p>将 “Serial line” 修改为在设备管理器中找到的 COM 端口。</p></li>
<li><p>设置 “Speed” 为 1500000。</p></li>
<li><p>点击 “Open” 按钮。</p></li>
</ol>
<p><img alt="_images/debug3.png" src="_images/debug3.png" /></p>
</div>
</div>
<div class="section" id="ubuntu-shang-shi-yong-chuan-kou-tiao-shi">
<h2>Ubuntu 上使用串口调试<a class="headerlink" href="#ubuntu-shang-shi-yong-chuan-kou-tiao-shi" title="永久链接至标题">¶</a></h2>
<p>在 Ubuntu 上可以有多种选择：</p>
<ul class="simple">
<li><p>minicom</p></li>
<li><p>picocom</p></li>
<li><p>kermit</p></li>
</ul>
<p>篇幅关系，以下就介绍 minicom 的使用。</p>
<div class="section" id="an-zhuang">
<h3>安装<a class="headerlink" href="#an-zhuang" title="永久链接至标题">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">minicom</span>
</pre></div>
</div>
<p>连接好串口线的，看一下串口设备文件是什么，下面示例是 <code class="docutils literal notranslate"><span class="pre">/dev/ttyUSB0</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls /dev/ttyUSB*
/dev/ttyUSB0
</pre></div>
</div>
<p>运行：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo minicom
Welcome to minicom 2.7
OPTIONS: I18n
Compiled on Jan  1 2014, 17:13:19.
Port /dev/ttyUSB0, 15:57:00
Press CTRL-A Z for help on special keys
</pre></div>
</div>
<p>以上提示 CTRL-A Z 是转义键，按 Ctrl-a 然后再按 Z 就可以调出帮助菜单。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="o">+-------------------------------------------------------------------+</span>
                          <span class="n">Minicom</span> <span class="n">Command</span> <span class="n">Summary</span>                      <span class="o">|</span>
  <span class="o">|</span>                                                                    <span class="o">|</span>
  <span class="o">|</span>              <span class="n">Commands</span> <span class="n">can</span> <span class="n">be</span> <span class="n">called</span> <span class="n">by</span> <span class="n">CTRL</span><span class="o">-</span><span class="n">A</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>                <span class="o">|</span>
  <span class="o">|</span>                                                                    <span class="o">|</span>
  <span class="o">|</span>               <span class="n">Main</span> <span class="n">Functions</span>                  <span class="n">Other</span> <span class="n">Functions</span>      <span class="o">|</span>
  <span class="o">|</span>                                                                    <span class="o">|</span>
  <span class="o">|</span> <span class="n">Dialing</span> <span class="n">directory</span><span class="o">..</span><span class="n">D</span>  <span class="n">run</span> <span class="n">script</span> <span class="p">(</span><span class="n">Go</span><span class="p">)</span><span class="o">....</span><span class="n">G</span> <span class="o">|</span> <span class="n">Clear</span> <span class="n">Screen</span><span class="o">.......</span><span class="n">C</span>  <span class="o">|</span>
  <span class="o">|</span> <span class="n">Send</span> <span class="n">files</span><span class="o">.........</span><span class="n">S</span>  <span class="n">Receive</span> <span class="n">files</span><span class="o">......</span><span class="n">R</span> <span class="o">|</span> <span class="n">cOnfigure</span> <span class="n">Minicom</span><span class="o">..</span><span class="n">O</span>  <span class="o">|</span>
  <span class="o">|</span> <span class="n">comm</span> <span class="n">Parameters</span><span class="o">....</span><span class="n">P</span>  <span class="n">Add</span> <span class="n">linefeed</span><span class="o">.......</span><span class="n">A</span> <span class="o">|</span> <span class="n">Suspend</span> <span class="n">minicom</span><span class="o">....</span><span class="n">J</span>  <span class="o">|</span>
  <span class="o">|</span> <span class="n">Capture</span> <span class="n">on</span><span class="o">/</span><span class="n">off</span><span class="o">.....</span><span class="n">L</span>  <span class="n">Hangup</span><span class="o">.............</span><span class="n">H</span> <span class="o">|</span> <span class="n">eXit</span> <span class="ow">and</span> <span class="n">reset</span><span class="o">.....</span><span class="n">X</span>  <span class="o">|</span>
  <span class="o">|</span> <span class="n">send</span> <span class="k">break</span><span class="o">.........</span><span class="n">F</span>  <span class="n">initialize</span> <span class="n">Modem</span><span class="o">...</span><span class="n">M</span> <span class="o">|</span> <span class="n">Quit</span> <span class="k">with</span> <span class="n">no</span> <span class="n">reset</span><span class="o">.</span><span class="n">Q</span>  <span class="o">|</span>
  <span class="o">|</span> <span class="n">Terminal</span> <span class="n">settings</span><span class="o">..</span><span class="n">T</span>  <span class="n">run</span> <span class="n">Kermit</span><span class="o">.........</span><span class="n">K</span> <span class="o">|</span> <span class="n">Cursor</span> <span class="n">key</span> <span class="n">mode</span><span class="o">....</span><span class="n">I</span>  <span class="o">|</span>
  <span class="o">|</span> <span class="n">lineWrap</span> <span class="n">on</span><span class="o">/</span><span class="n">off</span><span class="o">....</span><span class="n">W</span>  <span class="n">local</span> <span class="n">Echo</span> <span class="n">on</span><span class="o">/</span><span class="n">off</span><span class="o">..</span><span class="n">E</span> <span class="o">|</span> <span class="n">Help</span> <span class="n">screen</span><span class="o">........</span><span class="n">Z</span>  <span class="o">|</span>
  <span class="o">|</span> <span class="n">Paste</span> <span class="n">file</span><span class="o">.........</span><span class="n">Y</span>  <span class="n">Timestamp</span> <span class="n">toggle</span><span class="o">...</span><span class="n">N</span> <span class="o">|</span> <span class="n">scroll</span> <span class="n">Back</span><span class="o">........</span><span class="n">B</span>  <span class="o">|</span>
  <span class="o">|</span> <span class="n">Add</span> <span class="n">Carriage</span> <span class="n">Ret</span><span class="o">...</span><span class="n">U</span>                                               <span class="o">|</span>
  <span class="o">|</span>                                                                    <span class="o">|</span>
  <span class="o">|</span>             <span class="n">Select</span> <span class="n">function</span> <span class="ow">or</span> <span class="n">press</span> <span class="n">Enter</span> <span class="k">for</span> <span class="n">none</span><span class="o">.</span>               <span class="o">|</span>
  <span class="o">+--------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>根据提示按O进入设置界面，如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>           <span class="o">+-----</span><span class="p">[</span><span class="n">configuration</span><span class="p">]</span><span class="o">------+</span>
           <span class="o">|</span> <span class="n">Filenames</span> <span class="ow">and</span> <span class="n">paths</span>      <span class="o">|</span>
           <span class="o">|</span> <span class="n">File</span> <span class="n">transfer</span> <span class="n">protocols</span>  <span class="o">|</span>
           <span class="o">|</span> <span class="n">Serial</span> <span class="n">port</span> <span class="n">setup</span>        <span class="o">|</span>
           <span class="o">|</span> <span class="n">Modem</span> <span class="ow">and</span> <span class="n">dialing</span>        <span class="o">|</span>
           <span class="o">|</span> <span class="n">Screen</span> <span class="ow">and</span> <span class="n">keyboard</span>      <span class="o">|</span>
           <span class="o">|</span> <span class="n">Save</span> <span class="n">setup</span> <span class="k">as</span> <span class="n">dfl</span>        <span class="o">|</span>
           <span class="o">|</span> <span class="n">Save</span> <span class="n">setup</span> <span class="k">as</span><span class="o">..</span>          <span class="o">|</span>
           <span class="o">|</span> <span class="n">Exit</span>                     <span class="o">|</span>
           <span class="o">+--------------------------+</span>
</pre></div>
</div>
<p>把光标移动到“Serial port setup”，按enter进入串口设置界面，再输入前面提示的字母，选择对应的选项，设置成如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   +-----------------------------------------------------------------------+
   | A -    Serial Device      : /dev/ttyUSB0                              |
   | B - Lockfile Location     : /var/lock                                 |
   | C -   Callin Program      :                                           |
   | D -  Callout Program      :                                           |
   | E -    Bps/Par/Bits       : 1500000 8N1                               |
   | F - Hardware Flow Control : No                                        |
   | G - Software Flow Control : No                                        |
   |                                                                       |
   |    Change which setting?                                              |
   +-----------------------------------------------------------------------+
</pre></div>
</div>
<p><strong>注意：</strong><code class="docutils literal notranslate"><span class="pre">Hardware</span> <span class="pre">Flow</span> <span class="pre">Control</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Software</span> <span class="pre">Flow</span> <span class="pre">Control</span></code> 都要设成 No，否则可能导致无法输入。</p>
<p>设置完成后回到上一菜单，选择 <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">setup</span> <span class="pre">as</span> <span class="pre">dfl</span></code> 即可保存为默认配置，以后将默认使用该配置。</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bootmode.html" class="btn btn-neutral float-right" title="启动模式说明" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="started.html" class="btn btn-neutral float-left" title="入手指南" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Firefly Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>